import{r as u,L as Re,D as se,G as be,j as s,B as ne,H as xe,I as Te,v as Le,z as Ce,o as Be,ai as Ne,aj as He,am as _e,ak as we,an as Fe,ao as P,ag as ae,ap as $e,w as ze,V as Ge,W as z,b as D,ay as Se,aJ as F,aK as oe,aL as Ue,aI as re,aM as We,_ as W,aN as Ye,$ as fe,y as Ie,u as G,aO as Je,aP as Ke,aQ as Ze,aR as je,aS as qe,a0 as ee,aT as Qe,aU as Xe,aG as De,aV as et,aH as $,a5 as tt,aW as U,t as pe,aX as st,aY as Ve,aZ as nt,f as Ee,a1 as R,s as Oe,a_ as at,a$ as ot,b0 as rt,b1 as te,Z as lt,b2 as it,b3 as ct,b4 as ut,b5 as dt,Y as ft,b6 as pt,a8 as ht,b7 as mt,b8 as gt,C as yt,aw as he,a3 as vt,a4 as bt}from"./defaultSettings-8a8a553e.js";function xt(t,e,n={leading:!1}){const[o,r]=u.useState(t),l=u.useRef(!1),a=u.useRef(null),d=u.useRef(!1),i=()=>window.clearTimeout(a.current);return u.useEffect(()=>{l.current&&(!d.current&&n.leading?(d.current=!0,r(t)):(i(),a.current=window.setTimeout(()=>{d.current=!1,r(t)},e)))},[t,n.leading,e]),u.useEffect(()=>(l.current=!0,i),[]),[o,i]}var ke={root:"m_1b7284a3"};const Ct={},wt=xe((t,{radius:e,shadow:n})=>({root:{"--paper-radius":e===void 0?void 0:Te(e),"--paper-shadow":Le(n)}})),J=Re((t,e)=>{const n=se("Paper",Ct,t),{classNames:o,className:r,style:l,styles:a,unstyled:d,withBorder:i,vars:f,radius:x,shadow:g,variant:c,mod:p,...h}=n,m=be({name:"Paper",props:n,classes:ke,className:r,style:l,classNames:o,styles:a,unstyled:d,vars:f,varsResolver:wt});return s.jsx(ne,{ref:e,mod:[{"data-with-border":i},p],...m("root"),variant:c,...h})});J.classes=ke;J.displayName="@mantine/core/Paper";const St={},le=Ce((t,e)=>{const n=se("Autocomplete",St,t),{classNames:o,styles:r,unstyled:l,vars:a,dropdownOpened:d,defaultDropdownOpened:i,onDropdownClose:f,onDropdownOpen:x,onFocus:g,onBlur:c,onClick:p,onChange:h,data:m,value:b,defaultValue:S,selectFirstOptionOnChange:C,onOptionSubmit:w,comboboxProps:E,readOnly:k,disabled:O,filter:v,limit:y,withScrollArea:I,maxDropdownHeight:j,size:M,id:H,renderOption:L,autoComplete:_,scrollAreaProps:K,...V}=n,A=Be(H),B=Ne(m),Pe=He(B),[Z,ce]=_e({value:b,defaultValue:S,finalValue:"",onChange:h}),N=we({opened:d,defaultOpened:i,onDropdownOpen:x,onDropdownClose:()=>{f?.(),N.resetSelectedOption()}}),{resolvedClassNames:ue,resolvedStyles:de}=Fe({props:n,styles:r,classNames:o});return u.useEffect(()=>{C&&N.selectFirstOption()},[C,Z]),s.jsxs(P,{store:N,__staticSelector:"Autocomplete",classNames:ue,styles:de,unstyled:l,readOnly:k,onOptionSubmit:T=>{w?.(T),ce(Pe[T].label),N.closeDropdown()},size:M,...E,children:[s.jsx(P.Target,{autoComplete:_,children:s.jsx(ae,{ref:e,...V,size:M,__staticSelector:"Autocomplete",disabled:O,readOnly:k,value:Z,onChange:T=>{ce(T.currentTarget.value),N.openDropdown(),C&&N.selectFirstOption()},onFocus:T=>{N.openDropdown(),g?.(T)},onBlur:T=>{N.closeDropdown(),c?.(T)},onClick:T=>{N.openDropdown(),p?.(T)},classNames:ue,styles:de,unstyled:l,id:A})}),s.jsx($e,{data:B,hidden:k||O,filter:v,search:Z,limit:y,hiddenWhenEmpty:!0,withScrollArea:I,maxDropdownHeight:j,unstyled:l,labelId:V.label?`${A}-label`:void 0,"aria-label":V.label?void 0:V["aria-label"],renderOption:L,scrollAreaProps:K})]})});le.classes={...ae.classes,...P.classes};le.displayName="@mantine/core/Autocomplete";var Me={root:"m_6d731127"};const It={gap:"md",align:"stretch",justify:"flex-start"},jt=xe((t,{gap:e,align:n,justify:o})=>({root:{"--stack-gap":ze(e),"--stack-align":n,"--stack-justify":o}})),ie=Ce((t,e)=>{const n=se("Stack",It,t),{classNames:o,className:r,style:l,styles:a,unstyled:d,vars:i,align:f,justify:x,gap:g,variant:c,...p}=n,h=be({name:"Stack",props:n,classes:Me,className:r,style:l,classNames:o,styles:a,unstyled:d,vars:i,varsResolver:jt});return s.jsx(ne,{ref:e,...h("root"),variant:c,...p})});ie.classes=Me;ie.displayName="@mantine/core/Stack";/**
 * @license @tabler/icons-react v3.22.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dt=Ge("outline","grip-horizontal","IconGripHorizontal",[["path",{d:"M5 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M5 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M12 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M19 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M19 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]);const Vt={test:"https://test.bsdd.buildingsmart.org",production:"https://api.bsdd.buildingsmart.org"},Et="production";function Ot({callback:t,ifcEntity:e}){const{t:n}=z();D(Se);const o=F(oe),r=F(Ue);function l(d){const i=d?{...JSON.parse(JSON.stringify(d))}:{hasAssociations:[],isDefinedBy:[]};return i.isDefinedBy=o?.filter(f=>f.name!=="Attributes"),i.hasAssociations=[],r?.forEach(f=>{if(f.type==="IfcClassificationReference"&&f?.referencedSource?.location?.includes("https://identifier.buildingsmart.org/uri/buildingsmart/ifc/")){const{type:x,predefinedType:g}=We(f.identification);x&&(i.type=x),g&&(i.predefinedType=g),i.predefinedType||(i.predefinedType="NOTDEFINED")}else i.hasAssociations?.push(f)}),i}const a=()=>{const d=l(e);console.log(d),t(d)};return s.jsx(re,{color:"gray",fullWidth:!0,onClick:a,variant:"filled",children:n("apply")})}const me=25,kt=25;function ge({height:t,options:e,label:n,value:o,setValue:r,placeholder:l="Search values",disabled:a}){const[d,i]=u.useState(""),[f,x]=u.useState(e.slice(0,me)),g=u.useRef(null),c=we({onDropdownClose:()=>{c.resetSelectedOption(),c.focusTarget&&c.focusTarget()},onDropdownOpen:()=>{c.focusSearchInput&&c.focusSearchInput()}});u.useEffect(()=>{i(o?.label||"")},[o]),u.useEffect(()=>{const m=o===null?e.filter(b=>b?.label.toLowerCase().includes(d.toLowerCase().trim())||b?.value.toString().toLowerCase().includes(d.toLowerCase().trim())):e;x(m.slice(0,me))},[e,d,o]);const p=m=>{const{scrollTop:b,scrollHeight:S,clientHeight:C}=m.currentTarget,w=5;S-b<=C+w&&x(k=>{const O=k.length,v=e.filter(y=>y?.label.toLowerCase().includes(d.toLowerCase().trim())).slice(O,O+kt);return[...k,...v]})},h=f.map(m=>s.jsx(P.Option,{value:m.value,active:o?.value===m.value,children:s.jsxs(W,{gap:"sm",children:[o?.value===m.value?s.jsx(Ye,{size:12}):null,s.jsx(fe,{fz:"sm",opacity:a?.6:1,children:m.label}),s.jsxs(fe,{fz:"xs",opacity:.6,children:["(",m.value,")"]})]})},m.value));return s.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:s.jsxs(P,{store:c,onOptionSubmit:m=>{if(!a){const b=e.find(C=>C.value===m),S=b&&o?.value!==b.value?b:null;r(S),c.closeDropdown()}},disabled:a,children:[s.jsx(P.Target,{children:s.jsx(ae,{rightSection:!a&&s.jsx(Ie,{size:"sm",onMouseDown:m=>{m.preventDefault()},onClick:()=>{i(""),r(null)},"aria-label":"Clear value"}),label:n,value:o?`${o.label} (${o.value})`:d,onChange:m=>{a||(r(null),c.updateSelectedOptionIndex(),i(m.currentTarget.value))},onClick:()=>{a||c.openDropdown()},onBlur:()=>c.closeDropdown(),placeholder:a?"":l,disabled:a})}),t<80?s.jsx(P.Dropdown,{style:{maxHeight:"20em",overflowY:"auto"},ref:g,onScroll:p,children:s.jsx(P.Options,{children:h.length>0?h:s.jsx(P.Empty,{children:"Nothing found..."})})}):s.jsx(J,{withBorder:!0,my:"0.2em",style:{flexGrow:1,overflow:"auto",backgroundColor:a?"var(--mantine-color-gray-0)":"transparent",color:a?"var(--mantine-color-gray-6)":"inherit",pointerEvents:a?"none":"auto"},ref:g,onScroll:p,children:s.jsx(P.Options,{children:h.length>0?h:s.jsx(P.Empty,{children:"Nothing found..."})})})]})})}function Mt({height:t,handleMouseDown:e}){const n=G(),{t:o}=z(),[r,l]=u.useState(new Map),[a,d]=u.useState(new Map),i=D(Je),f=D(Ke),x=F(Se),g=F(Ze),c=F(je),p=F(qe);return u.useEffect(()=>{(async()=>{const b=Array.from(i.entries()).map(async([E,k])=>{if(c&&E===p){const{code:j,name:M,uri:H}=c;return[E,[{value:j,label:M,uri:H}]]}let O=[];const v=g[E],y=c?.classRelations?.map(j=>j.relatedClassUri),I=v?.filter(j=>y?.includes(j.uri));if(I&&I.length>0)O=I.map(j=>({value:j.code,label:j.name,uri:j.uri}));else try{O=(await n(Qe(E)).unwrap())?.map(M=>({value:M.code,label:M.name||"",uri:M.uri}))??[]}catch(j){console.error("Failed to fetch dictionary classes for",E,j),O=[]}return[E,O]}),S=await Promise.all(b),C=new Map(S);l(C);const w=new Map;C.forEach((E,k)=>{if(E.length===1)w.set(k,E[0]);else if(k in f){const O=f[k];if(O.length===1){const v=O[0];if(E.some(I=>I.value===v.identification)){const I={label:v.name||"",value:v.identification||"",uri:v.location||""};w.set(k,I)}}}}),d(w)})()},[i,g,n,f,c,p]),u.useEffect(()=>{(()=>{const m=Array.from(a.entries()).map(([b,S])=>{if(!S||!S.value)return null;const C=x[b];return{type:"IfcClassificationReference",name:S.label,location:S.uri,identification:S.value,referencedSource:{type:"IfcClassification",name:C.name,location:C.uri,edition:C.version,editionDate:C.releaseDate}}}).filter(b=>b!==null);m.length>0&&n(Xe(m))})()},[x,n,a]),s.jsxs(J,{style:{height:`${t}px`,position:"relative"},children:[Array.from(i.entries()).map(([h,m])=>{const b=h===p,S=h===c?.dictionaryUri;return b?s.jsx(ge,{height:t,label:m.name,options:r.get(h)||[],value:a.get(h)||null,setValue:C=>{const w=new Map(a);w.set(h,C),d(w)},placeholder:o("classifications.searchClassesPlaceholder"),disabled:r.get(h)?.length===1},h):S?null:s.jsx(ge,{height:t,label:m.name,options:r.get(h)||[],value:a.get(h)||null,setValue:C=>{const w=new Map(a);w.set(h,C),d(w)},placeholder:o("classifications.searchClassesPlaceholder"),disabled:r.get(h)?.length===1},h)}),s.jsx(ne,{onMouseDown:e,style:{marginTop:"4px"},children:s.jsx(ee,{label:o("classifications.dragResize"),withArrow:!0,children:s.jsx(re,{fullWidth:!0,variant:"subtle",size:"sm",color:"gray","aria-label":o("classifications.dragResize"),children:s.jsx(Dt,{})})})})]})}function q(t,e){return t==null||e==null?null:t.toLowerCase()!==e.toLowerCase()?`(${e})`:null}function At({label:t,description:e,value:n,setValue:o,disabled:r,inputContainer:l}){const{t:a}=z(),[d,i]=u.useState(!1),[f,x]=u.useState(!0),g=()=>a(f?"checkbox.indeterminate":d?"checkbox.true":"checkbox.false"),c=h=>{h.target.indeterminate=!1,o(h.target.checked)};u.useEffect(()=>{n===!0?(i(!0),x(!1)):n===!1?(i(!1),x(!1)):n===void 0&&(i(!1),x(!0))},[n]);const p=s.jsx(De,{description:g(),checked:d,indeterminate:f,type:"checkbox",onChange:h=>c(h),disabled:r});return s.jsx(et.Wrapper,{label:t,description:e,children:l?l(p):p})}const Q=(t,e,n,o)=>t.map(r=>{if(r.name===e){const l=r.hasProperties.map(a=>a.name===n?{...a,...o}:a);return{...r,hasProperties:l}}return r});function Pt({propertySet:t,property:e,propertyNaturalLanguageName:n}){const o=G(),r=D(oe),l=D(p=>p.ifcData.propertyIsInstanceMap),a=D(p=>p.ifcData.savedPropertyIsInstanceMap),[d,i]=u.useState(),f=t.name!=="Attributes",x=a.hasOwnProperty(e.name),g=l[e.name]||!1,c=p=>f&&g?s.jsx(ee,{label:pe("bsddSearch.property.tooltipEditInstance"),withArrow:!0,children:p}):p;return u.useEffect(()=>{switch(e.type){case"IfcPropertySingleValue":{e.nominalValue.type==="IfcBoolean"?i(s.jsx(At,{label:n,description:q(n,e.name),disabled:g,inputContainer:c,value:e.nominalValue.value,setValue:p=>{if(r&&t.name){const h={nominalValue:{...e.nominalValue,value:p}},m=Q(r,t.name,e.name,h);o(U(Object.values(m)))}}})):i(s.jsx($,{label:n,description:q(n,e.name),placeholder:e.nominalValue.value,value:e.nominalValue.value||"",disabled:g,inputContainer:c,onChange:p=>{if(r&&t.name){const h={nominalValue:{...e.nominalValue,value:p.target.value}},m=Q(r,t.name,e.name,h);o(U(Object.values(m)))}}}));break}case"IfcPropertyEnumeratedValue":{const p=e.enumerationValues?.[0]?.value,h=e.enumerationReference?.enumerationValues||[];i(s.jsx(tt,{label:n,description:q(n,e.name),value:p,inputContainer:c,disabled:g||e.enumerationReference?.enumerationValues?.length===1,onChange:m=>{if(r&&t.name){const b=h.find(w=>w.value===m),S={enumerationValues:b?[b]:[]},C=Q(r,t.name,e.name,S);o(U(Object.values(C)))}},data:h.map(m=>({value:m.value,label:m.value}))}));break}default:{i(s.jsx($,{placeholder:e.name,value:"{ifcProperty.nominalValue}",disabled:g,inputContainer:c}));break}}},[e,t,i,n,o,r,g]),s.jsxs(W,{children:[s.jsx("div",{style:{flex:1},children:d}),f&&s.jsx(ee,{label:pe("bsddSearch.property.setAsInstanceCheckboxTooltip"),withArrow:!0,children:s.jsx(De,{style:{marginTop:"2rem"},disabled:x,checked:g,onChange:p=>{x||o(st({propertyName:e.name,value:p.currentTarget.checked}))}})})]})}const Rt={Boolean:"IfcBoolean",Character:"IfcText",Integer:"IfcInteger",Real:"IfcReal",String:"IfcText",Time:"IfcDateTime"};function Y(t,e){const n=t&&Rt[t]||"default";let o;return t==="Boolean"&&typeof e=="string"?e.toUpperCase()==="TRUE"?o=!0:e.toUpperCase()==="FALSE"?o=!1:o=void 0:o=e,{type:n,value:o}}function Ae(t,e,n){let o;if(t&&t.isDefinedBy){let r=t.isDefinedBy.find(l=>l.name===e);if(r&&(o=r.hasProperties.find(l=>l.name===n)),o)return o;if(r=t.isDefinedBy.find(l=>l.name===""),r)return r.hasProperties.find(l=>l.name===n)}return o}function Tt(t,e,n,o){const l=Ae(e,n,o)?.nominalValue?.value??null;return Y(t,l)}function Lt(t,e,n,o,r){const l=Ae(e,n,o);if(l){if(l.type==="IfcPropertyEnumeratedValue")return r.filter(a=>l.enumerationValues?l.enumerationValues.some(d=>d.value===a.value):!1);if("nominalValue"in l&&l.nominalValue){const a=r.find(d=>d.value===l.nominalValue.value);return a?[a]:[]}}return[]}function Bt(t,e,n,o){const r=t.allowedValues?.map(d=>Y(t.dataType,d.value))||[],l={type:"IfcPropertyEnumeratedValue",name:e,enumerationReference:{type:"IfcPropertyEnumeration",name:e,enumerationValues:r},enumerationValues:r};t.propertyUri&&(l.specification=t.propertyUri);const a=t.predefinedValue?[Y(t.dataType,t.predefinedValue)]:Lt(t.dataType,o,n,e,r);return a.length>0&&(l.enumerationValues=a),l}function Nt(t,e,n,o){const r={type:"IfcPropertySingleValue",name:e,specification:t.propertyUri||""},l=t.predefinedValue?Y(t.dataType,t.predefinedValue):Tt(t.dataType,o,n,e);return l!==null&&(r.nominalValue=l),r}function Ht(t,e,n){const{propertyCode:o}=t,r=o||"unknown",l=t.allowedValues?Bt(t,r,e,n):Nt(t,r,e,n);return l.specification=t.propertyUri||"",l}function _t({mainDictionaryClassification:t,recursiveMode:e}){const n=G(),o=D(Ve),r=D(oe),l=D(nt),a=D(Ee),[d,i]=u.useState({});return u.useEffect(()=>{if(!t)return;const f={};[t].forEach(g=>{g.classProperties?.forEach(c=>{if(!c||!c.propertySet)return;const p=c.propertySet||g.name;f[p]||(f[p]={type:"IfcPropertySet",name:p,hasProperties:[]}),f[p].hasProperties.push(Ht(c,p,o))})}),n(U(Object.values(f)))},[n,o,t]),u.useEffect(()=>{if(!t)return;const f={};[t].forEach(g=>{g.classProperties?.forEach(c=>{c&&c.propertyUri&&(a&&l&&l[a]&&l[a][c.propertyUri]?f[c.propertyUri]=l[a][c.propertyUri]||"":f[c.propertyUri]=c.name)})}),i(f)},[t,e,o,l,a]),s.jsx("div",{children:u.Children.toArray(r?.map((f,x)=>s.jsx(R,{variant:"contained",radius:"xs",children:s.jsxs(R.Item,{value:f.name||"Unknown",style:x!==0?{borderTopWidth:0}:{},children:[s.jsx(R.Control,{children:f.name}),s.jsx(R.Panel,{children:s.jsx(ie,{children:u.Children.toArray(f.hasProperties.map(g=>{const c=g.specification?d[g.specification]:"";return s.jsx(Pt,{propertySet:f,property:g,propertyNaturalLanguageName:c})}))})})]},f.name||"Unknown")})))})}function Ft({api:t,defaultSelection:e}){const n=G(),{t:o}=z(),r=D(Oe),l=D(at),[a,d]=u.useState([]),i=u.useRef(null),[f,x]=u.useState(void 0),[g,c]=u.useState(""),[p]=xt(g,300),[h,m]=u.useState(!1),[b,S]=u.useState(-1);u.useEffect(()=>{e&&!h&&a.length>0&&(a.find(y=>y.value===e.value)?(x(e),c(e.label),i.current&&i.current.blur()):(c(e.label),i.current&&(i.current.focus(),i.current.setSelectionRange(0,i.current.value.length))),m(!0))},[e,h,a]);const C=u.useCallback(v=>{c(v),S(-1);const y=a.filter(I=>I.label.toLowerCase().includes(v.toLowerCase().trim())||I.synonyms?.some(j=>j.toLowerCase().includes(v.toLowerCase().trim())));d(y)},[a]),w=u.useCallback(v=>{const y=a.find(I=>I.value===v);y&&(x(y),i.current&&i.current.blur())},[a]),E=u.useCallback(v=>{if(v.key==="Enter"){if(b>=0&&b<a.length){const y=a[b];c(y.label),w(y.value)}else if(b===-1&&a.length>0){const y=a[0];c(y.label),w(y.value)}i.current&&i.current.blur()}else v.key==="ArrowDown"?S(y=>Math.min(y+1,a.length-1)):v.key==="ArrowUp"&&S(y=>Math.max(y-1,-1))},[b,a,w]);u.useEffect(()=>{if(r){const v={SearchText:p,DictionaryUri:r.ifcClassification.location};n(ot(v))}else n(rt([]))},[n,p,r]),u.useEffect(()=>{i.current&&i.current.focus()},[]),u.useEffect(()=>{if(l){if(l.count){const v=l.dictionary?.classes;v&&d(v.filter(y=>y.uri&&y.name).map(y=>({value:y.uri,label:y.name,synonyms:y.synonyms||[]})))}}else d([])},[l]),u.useEffect(()=>{n(f?te(f.value):te(null))},[n,f]);const k=u.useCallback(()=>{C(""),i.current&&i.current.focus(),x(void 0)},[C]),O=({options:v,search:y})=>{const I=y.toLowerCase().trim().split(" ");return v.filter(j=>{const M=j.label.toLowerCase().trim().split(" "),H=j.synonyms?.map(L=>L.toLowerCase().trim().split(" ")).flat()||[];return I.every(L=>M.some(_=>_.includes(L))||H.some(_=>_.includes(L)))})};return s.jsx(le,{label:`${o("searchMainDictionaryLabel")} ${r?r.ifcClassification.name:""}`,data:a,placeholder:"bSDD search...",value:g,onChange:C,onOptionSubmit:w,filter:O,onKeyDown:E,ref:i,style:{width:"100%"},rightSection:s.jsx(Ie,{size:"sm",onMouseDown:v=>{v.preventDefault()},onClick:k,"aria-label":"Clear value"})})}const X=60.7969;let ye=0,ve=0;function zt({selectedIfcEntity:t}){const{t:e}=z(),n=G(),{bsddSearchSave:o,bsddSearchCancel:r}=lt(),[l,a]=u.useState(),[d,i]=u.useState(!1),[f,x]=u.useState(new it(Vt[Et])),g=D(Oe),c=D(Ee),p=D(ct),h=D(ut),m=D(Ve),b=D(dt),S=D(ft),C=D(pt),[w,E]=u.useState(X),[k,O]=u.useState("auto"),[v,y]=u.useState(!1),I=D(je);u.useEffect(()=>{t&&n(ht(t))},[n,t]);function j(V,A){return{ifcData:[V],settings:S,propertyIsInstanceMap:A}}const M=u.useCallback(V=>{console.log("Sending bsddSearchSave data back to host",V),o(j(V,C)).then(A=>{console.log("Sent iFC data back to host",A)})},[o,C]);u.useEffect(()=>{if(!I||!v)return;const V=I.classProperties||[];n(mt({classProperties:V,languageCode:c}))},[I,v,c,n]),u.useEffect(()=>{if(!m||!g)return;const V=g.ifcClassification.location;m.hasAssociations?.forEach(A=>{if(A.type==="IfcClassificationReference"){const B=A;B.referencedSource?.location&&B.referencedSource.location===V&&(B.location&&n(te(B.location)),a({label:B.name,value:B.location}))}})},[g,m,n]),u.useEffect(()=>{b&&n(gt(b))},[b,n]),u.useEffect(()=>{O(`${w*p.length+48}px`)},[p.length,w]);const H=V=>{const A=ve+(V.clientY-ye)/p.length;E(A>X?A:X)},L=()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",L)},_=V=>{ye=V.clientY,ve=w,document.addEventListener("mousemove",H),document.addEventListener("mouseup",L)},K=V=>{y(V.includes("Propertysets"))};return s.jsxs(yt,{children:[s.jsx($,{type:"hidden",name:"ifcType",id:"ifcType",value:""}),s.jsx($,{type:"hidden",name:"name",id:"name",value:""}),s.jsx($,{type:"hidden",name:"material",id:"material",value:""}),s.jsx(W,{mx:"md",mt:"lg",mb:"sm",children:s.jsx(Ft,{api:f,defaultSelection:l})}),b?s.jsxs(s.Fragment,{children:[s.jsxs(R,{defaultValue:["Classifications"],multiple:!0,onChange:K,children:[s.jsxs(R.Item,{value:"Classifications",children:[s.jsx(R.Control,{children:s.jsx(he,{order:5,children:e("classificationsLabel")})}),s.jsx(R.Panel,{style:{height:k},children:s.jsx(Mt,{height:w,handleMouseDown:_})})]},"Classifications"),s.jsxs(R.Item,{value:"Propertysets",children:[s.jsx(R.Control,{children:s.jsx(he,{order:5,children:e("propertysetsLabel")})}),s.jsx(R.Panel,{children:s.jsx(_t,{mainDictionaryClassification:I,recursiveMode:d})})]},"Propertysets")]}),s.jsxs(W,{my:"sm",justify:"center",children:[s.jsx(Ot,{callback:M,ifcEntity:h}),s.jsx(re,{fullWidth:!0,variant:"light",color:"gray",onClick:r,children:e("cancel")})]})]}):s.jsxs(vt,{mx:"md",title:e("noClassificationSelected"),mt:"xl",children:[e("classSearchInstruction"),s.jsx(bt,{h:"md"}),e("needHelp")," ",s.jsx("a",{href:"https://github.com/buildingsmart-community/bSDD-Revit-plugin/wiki",target:"_blank",rel:"noreferrer",children:e("checkDocumentation")})]})]})}export{zt as B,J as P};
