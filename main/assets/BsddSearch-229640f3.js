import{r as u,L as Re,D as se,G as be,j as s,B as ne,H as xe,I as Te,v as Le,z as Ce,o as Be,ai as Ne,aj as He,am as _e,ak as we,an as Fe,ao as P,ag as ae,ap as $e,w as ze,V as Ge,W as z,b as D,ay as Se,aJ as F,aK as oe,aL as Ue,aI as re,aM as We,_ as W,aN as Ye,$ as fe,y as Ie,u as G,aO as Je,aP as Ke,aQ as Ze,aR as je,aS as qe,a0 as ee,aT as Qe,aU as Xe,aG as De,aV as et,aH as $,a5 as tt,aW as U,t as pe,aX as st,aY as Ve,aZ as nt,f as Ee,a1 as R,s as ke,a_ as at,a$ as ot,b0 as rt,b1 as te,Z as lt,b2 as it,b3 as ct,b4 as ut,b5 as dt,Y as ft,b6 as pt,a8 as ht,b7 as mt,b8 as gt,C as yt,aw as he,a3 as vt,a4 as bt}from"./defaultSettings-8a8a553e.js";function xt(t,e,n={leading:!1}){const[o,r]=u.useState(t),l=u.useRef(!1),a=u.useRef(null),f=u.useRef(!1),i=()=>window.clearTimeout(a.current);return u.useEffect(()=>{l.current&&(!f.current&&n.leading?(f.current=!0,r(t)):(i(),a.current=window.setTimeout(()=>{f.current=!1,r(t)},e)))},[t,n.leading,e]),u.useEffect(()=>(l.current=!0,i),[]),[o,i]}var Oe={root:"m_1b7284a3"};const Ct={},wt=xe((t,{radius:e,shadow:n})=>({root:{"--paper-radius":e===void 0?void 0:Te(e),"--paper-shadow":Le(n)}})),J=Re((t,e)=>{const n=se("Paper",Ct,t),{classNames:o,className:r,style:l,styles:a,unstyled:f,withBorder:i,vars:p,radius:x,shadow:y,variant:c,mod:v,...d}=n,h=be({name:"Paper",props:n,classes:Oe,className:r,style:l,classNames:o,styles:a,unstyled:f,vars:p,varsResolver:wt});return s.jsx(ne,{ref:e,mod:[{"data-with-border":i},v],...h("root"),variant:c,...d})});J.classes=Oe;J.displayName="@mantine/core/Paper";const St={},le=Ce((t,e)=>{const n=se("Autocomplete",St,t),{classNames:o,styles:r,unstyled:l,vars:a,dropdownOpened:f,defaultDropdownOpened:i,onDropdownClose:p,onDropdownOpen:x,onFocus:y,onBlur:c,onClick:v,onChange:d,data:h,value:m,defaultValue:S,selectFirstOptionOnChange:C,onOptionSubmit:w,comboboxProps:V,readOnly:O,disabled:k,filter:b,limit:g,withScrollArea:I,maxDropdownHeight:j,size:M,id:H,renderOption:L,autoComplete:_,scrollAreaProps:K,...E}=n,A=Be(H),B=Ne(h),Pe=He(B),[Z,ce]=_e({value:m,defaultValue:S,finalValue:"",onChange:d}),N=we({opened:f,defaultOpened:i,onDropdownOpen:x,onDropdownClose:()=>{p?.(),N.resetSelectedOption()}}),{resolvedClassNames:ue,resolvedStyles:de}=Fe({props:n,styles:r,classNames:o});return u.useEffect(()=>{C&&N.selectFirstOption()},[C,Z]),s.jsxs(P,{store:N,__staticSelector:"Autocomplete",classNames:ue,styles:de,unstyled:l,readOnly:O,onOptionSubmit:T=>{w?.(T),ce(Pe[T].label),N.closeDropdown()},size:M,...V,children:[s.jsx(P.Target,{autoComplete:_,children:s.jsx(ae,{ref:e,...E,size:M,__staticSelector:"Autocomplete",disabled:k,readOnly:O,value:Z,onChange:T=>{ce(T.currentTarget.value),N.openDropdown(),C&&N.selectFirstOption()},onFocus:T=>{N.openDropdown(),y?.(T)},onBlur:T=>{N.closeDropdown(),c?.(T)},onClick:T=>{N.openDropdown(),v?.(T)},classNames:ue,styles:de,unstyled:l,id:A})}),s.jsx($e,{data:B,hidden:O||k,filter:b,search:Z,limit:g,hiddenWhenEmpty:!0,withScrollArea:I,maxDropdownHeight:j,unstyled:l,labelId:E.label?`${A}-label`:void 0,"aria-label":E.label?void 0:E["aria-label"],renderOption:L,scrollAreaProps:K})]})});le.classes={...ae.classes,...P.classes};le.displayName="@mantine/core/Autocomplete";var Me={root:"m_6d731127"};const It={gap:"md",align:"stretch",justify:"flex-start"},jt=xe((t,{gap:e,align:n,justify:o})=>({root:{"--stack-gap":ze(e),"--stack-align":n,"--stack-justify":o}})),ie=Ce((t,e)=>{const n=se("Stack",It,t),{classNames:o,className:r,style:l,styles:a,unstyled:f,vars:i,align:p,justify:x,gap:y,variant:c,...v}=n,d=be({name:"Stack",props:n,classes:Me,className:r,style:l,classNames:o,styles:a,unstyled:f,vars:i,varsResolver:jt});return s.jsx(ne,{ref:e,...d("root"),variant:c,...v})});ie.classes=Me;ie.displayName="@mantine/core/Stack";/**
 * @license @tabler/icons-react v3.22.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dt=Ge("outline","grip-horizontal","IconGripHorizontal",[["path",{d:"M5 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M5 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M12 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M19 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M19 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]);const Vt={test:"https://test.bsdd.buildingsmart.org",production:"https://api.bsdd.buildingsmart.org"},Et="production";function kt({callback:t,ifcEntity:e}){const{t:n}=z();D(Se);const o=F(oe),r=F(Ue);function l(f){const i=f?{...JSON.parse(JSON.stringify(f))}:{hasAssociations:[],isDefinedBy:[]};return i.isDefinedBy=o?.filter(p=>p.name!=="Attributes"),i.hasAssociations=[],r?.forEach(p=>{if(p.type==="IfcClassificationReference"&&p?.referencedSource?.location?.includes("https://identifier.buildingsmart.org/uri/buildingsmart/ifc/")){const{type:x,predefinedType:y}=We(p.identification);x&&(i.type=x),y&&(i.predefinedType=y),i.predefinedType||(i.predefinedType="NOTDEFINED")}else i.hasAssociations?.push(p)}),i}const a=()=>{const f=l(e);console.log(f),t(f)};return s.jsx(re,{color:"gray",fullWidth:!0,onClick:a,variant:"filled",children:n("apply")})}const me=25,Ot=25;function ge({height:t,options:e,label:n,value:o,setValue:r,placeholder:l="Search values",disabled:a}){const[f,i]=u.useState(""),[p,x]=u.useState(e.slice(0,me)),y=u.useRef(null),c=we({onDropdownClose:()=>{c.resetSelectedOption(),c.focusTarget&&c.focusTarget()},onDropdownOpen:()=>{c.focusSearchInput&&c.focusSearchInput()}});u.useEffect(()=>{i(o?.label||"")},[o]),u.useEffect(()=>{const h=o===null?e.filter(m=>m?.label.toLowerCase().includes(f.toLowerCase().trim())||m?.value.toString().toLowerCase().includes(f.toLowerCase().trim())):e;x(h.slice(0,me))},[e,f,o]);const v=h=>{const{scrollTop:m,scrollHeight:S,clientHeight:C}=h.currentTarget,w=5;S-m<=C+w&&x(O=>{const k=O.length,b=e.filter(g=>g?.label.toLowerCase().includes(f.toLowerCase().trim())).slice(k,k+Ot);return[...O,...b]})},d=p.map(h=>s.jsx(P.Option,{value:h.value,active:o?.value===h.value,children:s.jsxs(W,{gap:"sm",children:[o?.value===h.value?s.jsx(Ye,{size:12}):null,s.jsx(fe,{fz:"sm",opacity:a?.6:1,children:h.label}),s.jsxs(fe,{fz:"xs",opacity:.6,children:["(",h.value,")"]})]})},h.value));return s.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:s.jsxs(P,{store:c,onOptionSubmit:h=>{if(!a){const m=e.find(C=>C.value===h),S=m&&o?.value!==m.value?m:null;r(S),c.closeDropdown()}},disabled:a,children:[s.jsx(P.Target,{children:s.jsx(ae,{rightSection:!a&&s.jsx(Ie,{size:"sm",onMouseDown:h=>{h.preventDefault()},onClick:()=>{i(""),r(null)},"aria-label":"Clear value"}),label:n,value:o?`${o.label} (${o.value})`:f,onChange:h=>{a||(r(null),c.updateSelectedOptionIndex(),i(h.currentTarget.value))},onClick:()=>{a||c.openDropdown()},onBlur:()=>c.closeDropdown(),placeholder:a?"":l,disabled:a})}),t<80?s.jsx(P.Dropdown,{style:{maxHeight:"20em",overflowY:"auto"},ref:y,onScroll:v,children:s.jsx(P.Options,{children:d.length>0?d:s.jsx(P.Empty,{children:"Nothing found..."})})}):s.jsx(J,{withBorder:!0,my:"0.2em",style:{flexGrow:1,overflow:"auto",backgroundColor:a?"var(--mantine-color-gray-0)":"transparent",color:a?"var(--mantine-color-gray-6)":"inherit",pointerEvents:a?"none":"auto"},ref:y,onScroll:v,children:s.jsx(P.Options,{children:d.length>0?d:s.jsx(P.Empty,{children:"Nothing found..."})})})]})})}function Mt({height:t,handleMouseDown:e}){const n=G(),{t:o}=z(),[r,l]=u.useState(new Map),[a,f]=u.useState(new Map),i=D(Je),p=D(Ke),x=F(Se),y=F(Ze),c=F(je),v=F(qe);return u.useEffect(()=>{(async()=>{const m=Array.from(i.entries()).map(async([V,O])=>{if(c&&V===v){const{code:j,name:M,uri:H}=c;return[V,[{value:j,label:M,uri:H}]]}let k=[];const b=y[V],g=c?.classRelations?.map(j=>j.relatedClassUri),I=b?.filter(j=>g?.includes(j.uri));if(I&&I.length>0)k=I.map(j=>({value:j.code,label:j.name,uri:j.uri}));else try{k=(await n(Qe(V)).unwrap())?.map(M=>({value:M.code,label:M.name||"",uri:M.uri}))??[]}catch(j){console.error("Failed to fetch dictionary classes for",V,j),k=[]}return[V,k]}),S=await Promise.all(m),C=new Map(S);l(C);const w=new Map;C.forEach((V,O)=>{if(V.length===1)w.set(O,V[0]);else if(O in p){const k=p[O];if(k.length===1){const b=k[0];if(V.some(I=>I.value===b.identification)){const I={label:b.name||"",value:b.identification||"",uri:b.location||""};w.set(O,I)}}}}),f(w)})()},[i,y,n,p,c,v]),u.useEffect(()=>{(()=>{const h=Array.from(a.entries()).map(([m,S])=>{if(!S||!S.value)return null;const C=x[m];return{type:"IfcClassificationReference",name:S.label,location:S.uri,identification:S.value,referencedSource:{type:"IfcClassification",name:C.name,location:C.uri,edition:C.version,editionDate:C.releaseDate}}}).filter(m=>m!==null);h.length>0&&n(Xe(h))})()},[x,n,a]),s.jsxs(J,{style:{height:`${t}px`,position:"relative"},children:[Array.from(i.entries()).map(([d,h])=>{const m=d===v,S=d===c?.dictionaryUri;return m?s.jsx(ge,{height:t,label:h.name,options:r.get(d)||[],value:a.get(d)||null,setValue:C=>{const w=new Map(a);w.set(d,C),f(w)},placeholder:o("classifications.searchClassesPlaceholder"),disabled:r.get(d)?.length===1},d):S?null:s.jsx(ge,{height:t,label:h.name,options:r.get(d)||[],value:a.get(d)||null,setValue:C=>{const w=new Map(a);w.set(d,C),f(w)},placeholder:o("classifications.searchClassesPlaceholder"),disabled:r.get(d)?.length===1},d)}),s.jsx(ne,{onMouseDown:e,style:{marginTop:"4px"},children:s.jsx(ee,{label:o("classifications.dragResize"),withArrow:!0,children:s.jsx(re,{fullWidth:!0,variant:"subtle",size:"sm",color:"gray","aria-label":o("classifications.dragResize"),children:s.jsx(Dt,{})})})})]})}function q(t,e){return t==null||e==null?null:t.toLowerCase()!==e.toLowerCase()?`(${e})`:null}function At({label:t,description:e,value:n,setValue:o,disabled:r,inputContainer:l}){const{t:a}=z(),[f,i]=u.useState(!1),[p,x]=u.useState(!0),y=()=>a(p?"checkbox.indeterminate":f?"checkbox.true":"checkbox.false"),c=d=>{d.target.indeterminate=!1,o(d.target.checked)};u.useEffect(()=>{n===!0?(i(!0),x(!1)):n===!1?(i(!1),x(!1)):n===void 0&&(i(!1),x(!0))},[n]);const v=s.jsx(De,{description:y(),checked:f,indeterminate:p,type:"checkbox",onChange:d=>c(d),disabled:r});return s.jsx(et.Wrapper,{label:t,description:e,children:l?l(v):v})}const Q=(t,e,n,o)=>t.map(r=>{if(r.name===e){const l=r.hasProperties.map(a=>a.name===n?{...a,...o}:a);return{...r,hasProperties:l}}return r});function Pt({propertySet:t,property:e,propertyNaturalLanguageName:n}){const o=G(),r=D(oe),l=D(d=>d.ifcData.propertyIsInstanceMap),a=D(d=>d.ifcData.savedPropertyIsInstanceMap),[f,i]=u.useState(),p=t.name!=="Attributes",x=a.hasOwnProperty(e.name),y=l[e.name]||!1,c=x||y,v=d=>p&&c?s.jsx(ee,{label:pe("bsddSearch.property.tooltipEditInstance"),withArrow:!0,children:d}):d;return u.useEffect(()=>{switch(e.type){case"IfcPropertySingleValue":{e.nominalValue.type==="IfcBoolean"?i(s.jsx(At,{label:n,description:q(n,e.name),disabled:c,inputContainer:v,value:e.nominalValue.value,setValue:d=>{if(r&&t.name){const h={nominalValue:{...e.nominalValue,value:d}},m=Q(r,t.name,e.name,h);o(U(Object.values(m)))}}})):i(s.jsx($,{label:n,description:q(n,e.name),placeholder:e.nominalValue.value,value:e.nominalValue.value||"",disabled:c,inputContainer:v,onChange:d=>{if(r&&t.name){const h={nominalValue:{...e.nominalValue,value:d.target.value}},m=Q(r,t.name,e.name,h);o(U(Object.values(m)))}}}));break}case"IfcPropertyEnumeratedValue":{const d=e.enumerationValues?.[0]?.value,h=e.enumerationReference?.enumerationValues||[];i(s.jsx(tt,{label:n,description:q(n,e.name),value:d,inputContainer:v,disabled:c||e.enumerationReference?.enumerationValues?.length===1,onChange:m=>{if(r&&t.name){const S=h.find(V=>V.value===m),C={enumerationValues:S?[S]:[]},w=Q(r,t.name,e.name,C);o(U(Object.values(w)))}},data:h.map(m=>({value:m.value,label:m.value}))}));break}default:{i(s.jsx($,{placeholder:e.name,value:"{ifcProperty.nominalValue}",disabled:c,inputContainer:v}));break}}},[e,t,i,n,o,r,c]),s.jsxs(W,{children:[s.jsx("div",{style:{flex:1},children:f}),p&&s.jsx(ee,{label:pe("bsddSearch.property.setAsInstanceCheckboxTooltip"),withArrow:!0,children:s.jsx(De,{style:{marginTop:"2rem"},disabled:x,checked:y,onChange:d=>{x||o(st({propertyName:e.name,value:d.currentTarget.checked}))}})})]})}const Rt={Boolean:"IfcBoolean",Character:"IfcText",Integer:"IfcInteger",Real:"IfcReal",String:"IfcText",Time:"IfcDateTime"};function Y(t,e){const n=t&&Rt[t]||"default";let o;return t==="Boolean"&&typeof e=="string"?e.toUpperCase()==="TRUE"?o=!0:e.toUpperCase()==="FALSE"?o=!1:o=void 0:o=e,{type:n,value:o}}function Ae(t,e,n){let o;if(t&&t.isDefinedBy){let r=t.isDefinedBy.find(l=>l.name===e);if(r&&(o=r.hasProperties.find(l=>l.name===n)),o)return o;if(r=t.isDefinedBy.find(l=>l.name===""),r)return r.hasProperties.find(l=>l.name===n)}return o}function Tt(t,e,n,o){const l=Ae(e,n,o)?.nominalValue?.value??null;return Y(t,l)}function Lt(t,e,n,o,r){const l=Ae(e,n,o);if(l){if(l.type==="IfcPropertyEnumeratedValue")return r.filter(a=>l.enumerationValues?l.enumerationValues.some(f=>f.value===a.value):!1);if("nominalValue"in l&&l.nominalValue){const a=r.find(f=>f.value===l.nominalValue.value);return a?[a]:[]}}return[]}function Bt(t,e,n,o){const r=t.allowedValues?.map(f=>Y(t.dataType,f.value))||[],l={type:"IfcPropertyEnumeratedValue",name:e,enumerationReference:{type:"IfcPropertyEnumeration",name:e,enumerationValues:r},enumerationValues:r};t.propertyUri&&(l.specification=t.propertyUri);const a=t.predefinedValue?[Y(t.dataType,t.predefinedValue)]:Lt(t.dataType,o,n,e,r);return a.length>0&&(l.enumerationValues=a),l}function Nt(t,e,n,o){const r={type:"IfcPropertySingleValue",name:e,specification:t.propertyUri||""},l=t.predefinedValue?Y(t.dataType,t.predefinedValue):Tt(t.dataType,o,n,e);return l!==null&&(r.nominalValue=l),r}function Ht(t,e,n){const{propertyCode:o}=t,r=o||"unknown",l=t.allowedValues?Bt(t,r,e,n):Nt(t,r,e,n);return l.specification=t.propertyUri||"",l}function _t({mainDictionaryClassification:t,recursiveMode:e}){const n=G(),o=D(Ve),r=D(oe),l=D(nt),a=D(Ee),[f,i]=u.useState({});return u.useEffect(()=>{if(!t)return;const p={};[t].forEach(y=>{y.classProperties?.forEach(c=>{if(!c||!c.propertySet)return;const v=c.propertySet||y.name;p[v]||(p[v]={type:"IfcPropertySet",name:v,hasProperties:[]}),p[v].hasProperties.push(Ht(c,v,o))})}),n(U(Object.values(p)))},[n,o,t]),u.useEffect(()=>{if(!t)return;const p={};[t].forEach(y=>{y.classProperties?.forEach(c=>{c&&c.propertyUri&&(a&&l&&l[a]&&l[a][c.propertyUri]?p[c.propertyUri]=l[a][c.propertyUri]||"":p[c.propertyUri]=c.name)})}),i(p)},[t,e,o,l,a]),s.jsx("div",{children:u.Children.toArray(r?.map((p,x)=>s.jsx(R,{variant:"contained",radius:"xs",children:s.jsxs(R.Item,{value:p.name||"Unknown",style:x!==0?{borderTopWidth:0}:{},children:[s.jsx(R.Control,{children:p.name}),s.jsx(R.Panel,{children:s.jsx(ie,{children:u.Children.toArray(p.hasProperties.map(y=>{const c=y.specification?f[y.specification]:"";return s.jsx(Pt,{propertySet:p,property:y,propertyNaturalLanguageName:c})}))})})]},p.name||"Unknown")})))})}function Ft({api:t,defaultSelection:e}){const n=G(),{t:o}=z(),r=D(ke),l=D(at),[a,f]=u.useState([]),i=u.useRef(null),[p,x]=u.useState(void 0),[y,c]=u.useState(""),[v]=xt(y,300),[d,h]=u.useState(!1),[m,S]=u.useState(-1);u.useEffect(()=>{e&&!d&&a.length>0&&(a.find(g=>g.value===e.value)?(x(e),c(e.label),i.current&&i.current.blur()):(c(e.label),i.current&&(i.current.focus(),i.current.setSelectionRange(0,i.current.value.length))),h(!0))},[e,d,a]);const C=u.useCallback(b=>{c(b),S(-1);const g=a.filter(I=>I.label.toLowerCase().includes(b.toLowerCase().trim())||I.synonyms?.some(j=>j.toLowerCase().includes(b.toLowerCase().trim())));f(g)},[a]),w=u.useCallback(b=>{const g=a.find(I=>I.value===b);g&&(x(g),i.current&&i.current.blur())},[a]),V=u.useCallback(b=>{if(b.key==="Enter"){if(m>=0&&m<a.length){const g=a[m];c(g.label),w(g.value)}else if(m===-1&&a.length>0){const g=a[0];c(g.label),w(g.value)}i.current&&i.current.blur()}else b.key==="ArrowDown"?S(g=>Math.min(g+1,a.length-1)):b.key==="ArrowUp"&&S(g=>Math.max(g-1,-1))},[m,a,w]);u.useEffect(()=>{if(r){const b={SearchText:v,DictionaryUri:r.ifcClassification.location};n(ot(b))}else n(rt([]))},[n,v,r]),u.useEffect(()=>{i.current&&i.current.focus()},[]),u.useEffect(()=>{if(l){if(l.count){const b=l.dictionary?.classes;b&&f(b.filter(g=>g.uri&&g.name).map(g=>({value:g.uri,label:g.name,synonyms:g.synonyms||[]})))}}else f([])},[l]),u.useEffect(()=>{n(p?te(p.value):te(null))},[n,p]);const O=u.useCallback(()=>{C(""),i.current&&i.current.focus(),x(void 0)},[C]),k=({options:b,search:g})=>{const I=g.toLowerCase().trim().split(" ");return b.filter(j=>{const M=j.label.toLowerCase().trim().split(" "),H=j.synonyms?.map(L=>L.toLowerCase().trim().split(" ")).flat()||[];return I.every(L=>M.some(_=>_.includes(L))||H.some(_=>_.includes(L)))})};return s.jsx(le,{label:`${o("searchMainDictionaryLabel")} ${r?r.ifcClassification.name:""}`,data:a,placeholder:"bSDD search...",value:y,onChange:C,onOptionSubmit:w,filter:k,onKeyDown:V,ref:i,style:{width:"100%"},rightSection:s.jsx(Ie,{size:"sm",onMouseDown:b=>{b.preventDefault()},onClick:O,"aria-label":"Clear value"})})}const X=60.7969;let ye=0,ve=0;function zt({selectedIfcEntity:t}){const{t:e}=z(),n=G(),{bsddSearchSave:o,bsddSearchCancel:r}=lt(),[l,a]=u.useState(),[f,i]=u.useState(!1),[p,x]=u.useState(new it(Vt[Et])),y=D(ke),c=D(Ee),v=D(ct),d=D(ut),h=D(Ve),m=D(dt),S=D(ft),C=D(pt),[w,V]=u.useState(X),[O,k]=u.useState("auto"),[b,g]=u.useState(!1),I=D(je);u.useEffect(()=>{t&&n(ht(t))},[n,t]);function j(E,A){return{ifcData:[E],settings:S,propertyIsInstanceMap:A}}const M=u.useCallback(E=>{console.log("Sending bsddSearchSave data back to host",E),o(j(E,C)).then(A=>{console.log("Sent iFC data back to host",A)})},[o,C]);u.useEffect(()=>{if(!I||!b)return;const E=I.classProperties||[];n(mt({classProperties:E,languageCode:c}))},[I,b,c,n]),u.useEffect(()=>{if(!h||!y)return;const E=y.ifcClassification.location;h.hasAssociations?.forEach(A=>{if(A.type==="IfcClassificationReference"){const B=A;B.referencedSource?.location&&B.referencedSource.location===E&&(B.location&&n(te(B.location)),a({label:B.name,value:B.location}))}})},[y,h,n]),u.useEffect(()=>{m&&n(gt(m))},[m,n]),u.useEffect(()=>{k(`${w*v.length+48}px`)},[v.length,w]);const H=E=>{const A=ve+(E.clientY-ye)/v.length;V(A>X?A:X)},L=()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",L)},_=E=>{ye=E.clientY,ve=w,document.addEventListener("mousemove",H),document.addEventListener("mouseup",L)},K=E=>{g(E.includes("Propertysets"))};return s.jsxs(yt,{children:[s.jsx($,{type:"hidden",name:"ifcType",id:"ifcType",value:""}),s.jsx($,{type:"hidden",name:"name",id:"name",value:""}),s.jsx($,{type:"hidden",name:"material",id:"material",value:""}),s.jsx(W,{mx:"md",mt:"lg",mb:"sm",children:s.jsx(Ft,{api:p,defaultSelection:l})}),m?s.jsxs(s.Fragment,{children:[s.jsxs(R,{defaultValue:["Classifications"],multiple:!0,onChange:K,children:[s.jsxs(R.Item,{value:"Classifications",children:[s.jsx(R.Control,{children:s.jsx(he,{order:5,children:e("classificationsLabel")})}),s.jsx(R.Panel,{style:{height:O},children:s.jsx(Mt,{height:w,handleMouseDown:_})})]},"Classifications"),s.jsxs(R.Item,{value:"Propertysets",children:[s.jsx(R.Control,{children:s.jsx(he,{order:5,children:e("propertysetsLabel")})}),s.jsx(R.Panel,{children:s.jsx(_t,{mainDictionaryClassification:I,recursiveMode:f})})]},"Propertysets")]}),s.jsxs(W,{my:"sm",justify:"center",children:[s.jsx(kt,{callback:M,ifcEntity:d}),s.jsx(re,{fullWidth:!0,variant:"light",color:"gray",onClick:r,children:e("cancel")})]})]}):s.jsxs(vt,{mx:"md",title:e("noClassificationSelected"),mt:"xl",children:[e("classSearchInstruction"),s.jsx(bt,{h:"md"}),e("needHelp")," ",s.jsx("a",{href:"https://github.com/buildingsmart-community/bSDD-Revit-plugin/wiki",target:"_blank",rel:"noreferrer",children:e("checkDocumentation")})]})]})}export{zt as B,J as P};
